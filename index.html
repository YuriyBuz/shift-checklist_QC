<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QC Master | FoodLine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Base Variables for Theming - Matching Shift Master */
        :root {
            --bg-color: #f8fafc;
            --card-bg-color: #ffffff;
            --text-color: #1e293b;
            --text-muted-color: #64748b;
            --item-bg-color: #f1f5f9;
            --item-hover-bg-color: #e2e8f0;
            --border-color: #e2e8f0;
            --priority-border-color: #fecaca;
            --header-icon-hover-bg: #e5e7eb;
        }

        .dark {
            --bg-color: #0f172a; /* Darker slate */
            --card-bg-color: #1e293b;
            --text-color: #f1f5f9;
            --text-muted-color: #94a3b8;
            --item-bg-color: #334155;
            --item-hover-bg-color: #475569;
            --border-color: #334155;
            --priority-border-color: #991b1b;
            --header-icon-hover-bg: #334155;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 6rem;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* General Component Styling */
        .card { background-color: var(--card-bg-color); transition: background-color 0.3s ease; }
        .text-muted { color: var(--text-muted-color); }
        .header-icon:hover { background-color: var(--header-icon-hover-bg); }

        /* Checklist Items */
        .checklist-item {
            background-color: var(--item-bg-color);
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }
        .checklist-item:hover { background-color: var(--item-hover-bg-color); }
        
        .checklist-item.completed {
            background-color: rgba(16, 185, 129, 0.1); /* Emerald tint */
            border-color: #10b981;
        }
        .dark .checklist-item.completed {
            background-color: rgba(16, 185, 129, 0.1);
            border-color: #059669;
        }

        .checklist-item.completed .task-text { 
            text-decoration: line-through; 
            color: var(--text-muted-color);
        }
        
        /* Icons */
        .checkbox-icon {
            width: 1.5rem;
            height: 1.5rem;
            border: 2px solid #cbd5e1;
            border-radius: 0.375rem;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            background: var(--card-bg-color);
            transition: all 0.2s;
        }
        .dark .checkbox-icon { border-color: #64748b; }

        .checklist-item.completed .checkbox-icon {
            background-color: #10b981;
            border-color: #10b981;
        }
        .checklist-item.completed .checkbox-icon::after {
            content: '‚úî';
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        /* Problem/Info States */
        .checklist-item.has-problem { border-color: #ef4444; background-color: rgba(239, 68, 68, 0.05); }
        .checklist-item.has-info { border-color: #3b82f6; background-color: rgba(59, 130, 246, 0.05); }

        /* Navigation */
        .nav-button {
            background-color: var(--card-bg-color);
            color: var(--text-muted-color);
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }
        .nav-button:hover { background-color: var(--item-hover-bg-color); }
        .nav-button.active {
            background-color: #059669; /* Emerald 600 */
            color: white;
            border-color: #059669;
            box-shadow: 0 4px 6px -1px rgba(5, 150, 105, 0.2);
        }

        /* Journal Tabs */
        .journal-tab {
            background-color: var(--item-bg-color);
            color: var(--text-muted-color);
            border: 1px solid transparent;
        }
        .journal-tab.active {
            background-color: #f97316; /* Orange 500 */
            color: white;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(249, 115, 22, 0.2);
        }

        /* Inputs */
        input, select, textarea {
            background-color: var(--card-bg-color) !important;
            color: var(--text-color) !important;
            border: 1px solid var(--border-color) !important;
            transition: border-color 0.2s, ring 0.2s;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #10b981 !important;
            outline: none;
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }

        /* Checkboxes in Forms */
        input[type="checkbox"] {
            appearance: none;
            background-color: var(--card-bg-color);
            border: 2px solid var(--border-color);
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 0.25rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        input[type="checkbox"]:checked {
            background-color: #10b981;
            border-color: #10b981;
        }
        input[type="checkbox"]:checked::after {
            content: '‚úî';
            color: white;
            font-size: 0.8rem;
        }

        /* Modals */
        .modal-overlay { background-color: rgba(0, 0, 0, 0.6); backdrop-filter: blur(2px); z-index: 1000; }
        .comment-text { font-size: 0.875rem; color: var(--text-muted-color); margin-top: 0.5rem; padding-left: 2.25rem; font-style: italic; }
        .comment-text.alert { color: #ef4444; font-weight: 600; }
        .comment-text.info { color: #3b82f6; font-weight: 600; }

        /* Print Styles */
        @media print {
            body { padding-bottom: 0; background: white; color: black; }
            header, nav, #footerStatus, .modal-overlay, button { display: none !important; }
            .card { border: none; box-shadow: none; padding: 0; }
            .checklist-item { border: 1px solid #ccc; page-break-inside: avoid; }
        }
        
        .spinner { border: 3px solid rgba(0,0,0,0.1); width: 24px; height: 24px; border-radius: 50%; border-left-color: #10b981; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="font-sans antialiased selection:bg-emerald-100 selection:text-emerald-900">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-[2000] flex flex-col gap-2"></div>

    <div class="container mx-auto max-w-3xl p-4 sm:p-6 lg:p-8">
        
        <!-- Header (Matching Shift Master Style) -->
        <header class="relative text-center mb-6">
            <div class="absolute top-0 left-0">
                <div id="current-date" class="text-muted text-xs font-mono mt-1 font-bold"></div>
            </div>

            <img src="https://foodline-production.com/wp-content/uploads/2021/10/3752781497_3752781497.webp" alt="Logo" class="w-24 h-auto mx-auto mb-4 rounded-lg shadow-sm bg-white p-1" onerror="this.src='https://placehold.co/100x50?text=FoodLine'">
            <h1 class="text-2xl sm:text-3xl font-bold tracking-tight">QC Master</h1>
            <p class="text-muted text-sm font-medium">–ö–æ–Ω—Ç—Ä–æ–ª—å —è–∫–æ—Å—Ç—ñ —Ç–∞ –±–µ–∑–ø–µ—á–Ω–æ—Å—Ç—ñ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó</p>

            <div class="absolute top-0 right-0 flex space-x-2">
                <button id="themeToggle" class="p-2 rounded-full text-muted header-icon transition-colors focus:outline-none" title="–ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>
                </button>
            </div>
        </header>

        <!-- Employee Select Card -->
        <div class="mb-6 card p-4 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
            <label class="block text-sm font-bold mb-2 text-muted">–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä —è–∫–æ—Å—Ç—ñ:</label>
            <select id="employeeSelect" class="block w-full p-3 border rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none transition-all text-sm font-medium">
                <option value="">–û–±–µ—Ä—ñ—Ç—å –∑—ñ —Å–ø–∏—Å–∫—É...</option>
            </select>
            <p id="employeeSelectionHint" class="text-red-500 text-xs mt-2 hidden font-bold flex items-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                –ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å —Å–≤–æ—î —ñ–º'—è!
            </p>
        </div>

        <!-- Navigation Tabs -->
        <nav class="grid grid-cols-4 gap-2 mb-6 p-1 bg-slate-100 dark:bg-slate-800 rounded-xl">
            <button data-view="start" class="nav-button active py-2 px-1 rounded-lg font-bold text-xs sm:text-sm text-center">–ü–æ—á–∞—Ç–æ–∫<br><span class="text-[10px] font-normal opacity-75">10:00</span></button>
            <button data-view="during" class="nav-button py-2 px-1 rounded-lg font-bold text-xs sm:text-sm text-center">–ó–º—ñ–Ω–∞<br><span class="text-[10px] font-normal opacity-75">20:00</span></button>
            <button data-view="end" class="nav-button py-2 px-1 rounded-lg font-bold text-xs sm:text-sm text-center">–ö—ñ–Ω–µ—Ü—å<br><span class="text-[10px] font-normal opacity-75">20:00</span></button>
            <button data-view="journal" class="nav-button py-2 px-1 rounded-lg font-bold text-xs sm:text-sm text-center text-orange-600 dark:text-orange-400">üìñ –ñ—É—Ä–Ω–∞–ª</button>
        </nav>

        <main>
            <!-- CHECKLIST SECTIONS -->
            <section id="startShiftSection" class="view-section">
                <div class="card p-4 sm:p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl sm:text-2xl font-bold text-emerald-700 dark:text-emerald-400">–ü–æ—á–∞—Ç–æ–∫ –∑–º—ñ–Ω–∏</h2>
                        <button id="resetStartBtn" class="px-3 py-1.5 bg-orange-500 text-white text-xs sm:text-sm font-bold rounded-lg hover:bg-orange-600 transition-colors shadow-sm">–°–∫–∏–Ω—É—Ç–∏</button>
                    </div>
                    <ul class="space-y-3" id="list-start"></ul>
                </div>
            </section>

            <section id="duringShiftSection" class="view-section hidden">
                <div class="card p-4 sm:p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl sm:text-2xl font-bold text-blue-700 dark:text-blue-400">–ü—Ä–æ—Ç—è–≥–æ–º –∑–º—ñ–Ω–∏</h2>
                        <button id="resetDuringBtn" class="px-3 py-1.5 bg-orange-500 text-white text-xs sm:text-sm font-bold rounded-lg hover:bg-orange-600 transition-colors shadow-sm">–°–∫–∏–Ω—É—Ç–∏</button>
                    </div>
                    <ul class="space-y-3" id="list-during"></ul>
                </div>
            </section>

            <section id="endShiftSection" class="view-section hidden">
                <div class="card p-4 sm:p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl sm:text-2xl font-bold text-sky-700 dark:text-sky-400">–ö—ñ–Ω–µ—Ü—å –∑–º—ñ–Ω–∏</h2>
                        <button id="resetEndBtn" class="px-3 py-1.5 bg-orange-500 text-white text-xs sm:text-sm font-bold rounded-lg hover:bg-orange-600 transition-colors shadow-sm">–°–∫–∏–Ω—É—Ç–∏</button>
                    </div>
                    <ul class="space-y-3" id="list-end"></ul>
                </div>
            </section>

            <!-- JOURNAL SECTION -->
            <section id="journalSection" class="view-section hidden">
                <div class="card p-4 sm:p-6 rounded-2xl shadow-md border border-slate-200 dark:border-slate-700">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl sm:text-2xl font-bold">üìù –ñ—É—Ä–Ω–∞–ª –∫–æ–Ω—Ç—Ä–æ–ª—é</h2>
                        <button id="resetJournalBtn" class="px-3 py-1.5 bg-orange-500 text-white text-xs sm:text-sm font-bold rounded-lg hover:bg-orange-600 transition-colors shadow-sm">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                    </div>
                    
                    <div class="flex p-1 bg-slate-100 dark:bg-slate-800 rounded-xl mb-6">
                        <button data-jtab="testing" class="journal-tab flex-1 py-2 rounded-lg font-bold text-sm transition-all">üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è</button>
                        <button data-jtab="labeling" class="journal-tab active flex-1 py-2 rounded-lg font-bold text-sm transition-all">üè∑Ô∏è –ï—Ç–∏–∫–µ—Ç—É–≤–∞–Ω–Ω—è</button>
                    </div>

                    <!-- Labeling Form -->
                    <div id="form-labeling" class="space-y-4 animate-fade-in hidden">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–ß–∞—Å</label>
                                <input type="time" id="lbl-time" class="w-full p-3 rounded-xl mt-1 font-medium">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–ú–∞—à–∏–Ω–∞</label>
                                <select id="lbl-machine" class="w-full p-3 rounded-xl mt-1 font-medium">
                                    <option value="A">–ú–∞—à–∏–Ω–∞ –ê (–°–ö-010)</option>
                                    <option value="B">–ú–∞—à–∏–Ω–∞ –í (ALM)</option>
                                    <option value="C">–ú–∞—à–∏–Ω–∞ –° (–†–æ—Ç–æ—Ä)</option>
                                    <option value="D">–ú–∞—à–∏–Ω–∞ D (–ö–æ–Ω—É—Å)</option>
                                    <option value="F">–ú–∞—à–∏–Ω–∞ F (–ü–ª—è—à–∫–∞)</option>
                                    <option value="E">–†—É—á–Ω–∏–π –¥–∞—Ç–µ—Ä E</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="text-xs font-bold text-muted uppercase">1. –¢–ú (–¢–æ—Ä–≥–æ–≤–∞ –ú–∞—Ä–∫–∞)</label>
                            <select id="lbl-tm" class="w-full p-3 rounded-xl mt-1 font-medium">
                                <option value="">–û–±–µ—Ä—ñ—Ç—å –∑—ñ —Å–ø–∏—Å–∫—É...</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-xs font-bold text-muted uppercase">2. –ü—Ä–æ–¥—É–∫—Ç</label>
                            <input type="text" id="lbl-product" list="lbl-product-list" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –¢–ú..." disabled>
                            <datalist id="lbl-product-list"></datalist>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">‚Ññ –ó–∞–≤–¥–∞–Ω–Ω—è</label>
                                <input type="number" id="lbl-task" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="12345">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–ß–∏—Å—Ç–æ—Ç–∞ —ñ —Å–∞–Ω. —Å—Ç–∞–Ω</label>
                                <select id="lbl-sanitary" class="w-full p-3 rounded-xl mt-1 font-medium">
                                    <option value="" selected disabled>–û–±–µ—Ä—ñ—Ç—å...</option>
                                    <option value="–í—ñ–¥–ø–æ–≤—ñ–¥–∞—î">‚úÖ –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î</option>
                                    <option value="–ù–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î">‚ùå –ù–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–î–∞—Ç–∞ –Ω–∞ –µ—Ç–∏–∫–µ—Ç—Ü—ñ</label>
                                <input type="date" id="lbl-label-date" class="w-full p-3 rounded-xl mt-1 font-medium">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–ü–∞—Ä—Ç—ñ—è</label>
                                <input type="text" id="lbl-label-batch" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="L..." title="–§–æ—Ä–º–∞—Ç: L...">
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–ü–ª—ñ–≤–∫–∞ (–º–º)</label>
                                <input type="text" id="lbl-width" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="400/350">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–¢. —Ç—É–Ω–µ–ª—é (¬∞C)</label>
                                <input type="number" id="lbl-temp" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="185">
                            </div>
                        </div>
                        
                        <!-- Checkboxes Grid -->
                        <div class="bg-slate-50 dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 grid grid-cols-2 gap-4">
                            <label class="flex items-center gap-3 cursor-pointer select-none">
                                <input type="checkbox" id="check-pack" class="journal-checkbox rounded"> 
                                <span class="text-sm font-semibold">–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø–∞–∫–∞</span>
                            </label>
                            <label class="flex items-center gap-3 cursor-pointer select-none">
                                <input type="checkbox" id="check-sticker" class="journal-checkbox rounded"> 
                                <span class="text-sm font-semibold">–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Å—Ç—ñ–∫–µ—Ä–∞</span>
                            </label>
                            <label class="flex items-center gap-3 cursor-pointer select-none">
                                <input type="checkbox" id="check-pallet" class="journal-checkbox rounded"> 
                                <span class="text-sm font-semibold">–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –ø–∞–ª–µ—Ç—É–≤–∞–Ω–Ω—è</span>
                            </label>
                            <label class="flex items-center gap-3 cursor-pointer select-none">
                                <input type="checkbox" id="check-layout" class="journal-checkbox rounded"> 
                                <span class="text-sm font-semibold">–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ä–æ–∑–∫–ª–∞–¥–∫–∏</span>
                            </label>
                            <label class="flex items-center gap-3 cursor-pointer select-none col-span-2">
                                <input type="checkbox" id="check-label-applied" class="journal-checkbox rounded"> 
                                <span class="text-sm font-semibold">–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –Ω–∞–Ω–µ—Å–µ–Ω–æ—ó –µ—Ç–∏–∫–µ—Ç–∫–∏</span>
                            </label>
                        </div>

                        <textarea id="lbl-comment" class="w-full p-3 rounded-xl font-medium" rows="2" placeholder="–î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫–æ–º–µ–Ω—Ç–∞—Ä..."></textarea>
                    </div>

                    <!-- Testing Form -->
                    <div id="form-testing" class="space-y-4 animate-fade-in">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–ß–∞—Å</label>
                                <input type="time" id="tst-time" class="w-full p-3 rounded-xl mt-1 font-medium">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–í–∞—Ä–Ω–∏–∫</label>
                                <select id="tst-cookName" class="w-full p-3 rounded-xl mt-1 font-medium">
                                    <option value="">–û–±–µ—Ä—ñ—Ç—å –∑—ñ —Å–ø–∏—Å–∫—É...</option>
                                    <option value="–ó–∞–≥—É—Ä–∞ –Ü–≤–∞–Ω –ë–æ—Ä–∏—Å–æ–≤–∏—á">–ó–∞–≥—É—Ä–∞ –Ü–≤–∞–Ω –ë–æ—Ä–∏—Å–æ–≤–∏—á</option>
                                    <option value="–°–æ–ª–¥–∞—Ç–æ–≤–∞ –Ü—Ä–∏–Ω–∞ –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞">–°–æ–ª–¥–∞—Ç–æ–≤–∞ –Ü—Ä–∏–Ω–∞ –í–æ–ª–æ–¥–∏–º–∏—Ä—ñ–≤–Ω–∞</option>
                                    <option value="–°–∞–¥–∏—Ä—ñ–Ω–∞ –û–ª—å–≥–∞ –ê–Ω–∞—Ç–æ–ª—ñ—ó–≤–Ω–∞">–°–∞–¥–∏—Ä—ñ–Ω–∞ –û–ª—å–≥–∞ –ê–Ω–∞—Ç–æ–ª—ñ—ó–≤–Ω–∞</option>
                                    <option value="–ö–æ–∑—É—Ä–∞–∫ –Ü–≤–∞–Ω –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á">–ö–æ–∑—É—Ä–∞–∫ –Ü–≤–∞–Ω –ú–∏–∫–æ–ª–∞–π–æ–≤–∏—á</option>
                                    <option value="–ö–æ—Ä–∞–±–ª—ñ–Ω –î–º–∏—Ç—Ä–æ –†—É—Å–ª–∞–Ω–æ–≤–∏—á">–ö–æ—Ä–∞–±–ª—ñ–Ω –î–º–∏—Ç—Ä–æ –†—É—Å–ª–∞–Ω–æ–≤–∏—á</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="text-xs font-bold text-muted uppercase">–ü—Ä–æ–¥—É–∫—Ç (–ö–æ–¥ | –ù–∞–∑–≤–∞)</label>
                            <input type="text" id="tst-product" list="tst-product-list" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥ –∞–±–æ –Ω–∞–∑–≤—É..." autocomplete="off">
                            <datalist id="tst-product-list"></datalist>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">‚Ññ –ó–∞–≤–¥–∞–Ω–Ω—è</label>
                                <input type="number" id="tst-task" class="w-full p-3 rounded-xl mt-1 font-medium" placeholder="12345">
                            </div>
                            <div>
                                <label class="text-xs font-bold text-muted uppercase">–î–∞—Ç–∞ –≤–∞—Ä–∫–∏</label>
                                <input type="date" id="tst-cookDate" class="w-full p-3 rounded-xl mt-1 font-medium">
                            </div>
                        </div>
                        
                        <div class="bg-orange-500 text-white p-2 rounded-lg text-sm font-bold text-center shadow-sm uppercase tracking-wide">–û—Ä–≥–∞–Ω–æ–ª–µ–ø—Ç–∏–∫–∞</div>
                        <div class="grid grid-cols-2 gap-4">
                            <select id="tst-color" class="p-3 rounded-xl font-medium"><option value="" selected disabled>–ö–æ–ª—ñ—Ä...</option><option value="+">–ö–æ–ª—ñ—Ä: –û–ö</option><option value="-">–ö–æ–ª—ñ—Ä: –ë—Ä–∞–∫</option></select>
                            <select id="tst-aroma" class="p-3 rounded-xl font-medium"><option value="" selected disabled>–ê—Ä–æ–º–∞—Ç...</option><option value="+">–ê—Ä–æ–º–∞—Ç: –û–ö</option><option value="-">–ê—Ä–æ–º–∞—Ç: –ë—Ä–∞–∫</option></select>
                            <select id="tst-taste" class="p-3 rounded-xl font-medium"><option value="" selected disabled>–°–º–∞–∫...</option><option value="+">–°–º–∞–∫: –û–ö</option><option value="-">–°–º–∞–∫: –ë—Ä–∞–∫</option></select>
                            <select id="tst-consist" class="p-3 rounded-xl font-medium"><option value="" selected disabled>–ö–æ–Ω—Å–∏—Å—Ç...</option><option value="+">–ö–æ–Ω—Å–∏—Å—Ç: –û–ö</option><option value="-">–ö–æ–Ω—Å–∏—Å—Ç: –ë—Ä–∞–∫</option></select>
                        </div>
                        
                        <div class="bg-orange-500 text-white p-2 rounded-lg text-sm font-bold text-center shadow-sm uppercase tracking-wide">–§—ñ–∑–∏–∫–æ-—Ö—ñ–º—ñ—è</div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="text-[10px] font-bold text-muted uppercase">–°—É—Ö—ñ (%)</label><input type="number" step="0.1" id="tst-dry" class="w-full p-2 rounded-xl"></div>
                            <div><label class="text-[10px] font-bold text-muted uppercase">–í'—è–∑–∫—ñ—Å—Ç—å</label><input type="text" id="tst-visc" class="w-full p-2 rounded-xl"></div>
                            <div><label class="text-[10px] font-bold text-muted uppercase">pH</label><input type="number" step="0.01" id="tst-ph" class="w-full p-2 rounded-xl"></div>
                            <div>
                                <label class="text-[10px] font-bold text-muted uppercase">–°—Ç—ñ–π–∫—ñ—Å—Ç—å</label>
                                <select id="tst-stab" class="w-full p-2 rounded-xl">
                                    <option value="" selected disabled>–û–±–µ—Ä—ñ—Ç—å...</option>
                                    <option value="+">–°—Ç—ñ–π–∫–∞ (+)</option>
                                    <option value="-">–ù–µ —Å—Ç—ñ–π–∫–∞ (-)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <button id="submitJournalBtn" class="w-full bg-emerald-600 text-white font-bold py-4 rounded-xl mt-6 shadow-lg hover:bg-emerald-700 hover:shadow-xl active:scale-[0.98] transition-all flex items-center justify-center gap-2 text-lg">
                        <span id="btnText">üöÄ –í–Ü–î–ü–†–ê–í–ò–¢–ò –î–ê–ù–Ü</span>
                        <div id="btnSpinner" class="spinner hidden border-white"></div>
                    </button>
                    <p id="journalStatusMsg" class="text-center mt-3 text-sm font-bold text-emerald-600 dark:text-emerald-400"></p>
                </div>
            </section>
        </main>
    </div>

    <!-- Footer Progress -->
    <div id="footerStatus" class="fixed bottom-0 left-0 right-0 card p-4 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] flex items-center justify-between z-40 border-t border-slate-200 dark:border-slate-700">
        <div class="w-full max-w-3xl mx-auto">
            <div class="flex justify-between text-xs text-muted mb-1 font-bold">
                <span>–ü—Ä–æ–≥—Ä–µ—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</span>
                <span id="progressText">0/0</span>
            </div>
            <div class="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2.5 overflow-hidden">
                <div id="progressBar" class="bg-emerald-500 h-full rounded-full transition-all duration-500 shadow-[0_0_10px_rgba(16,185,129,0.5)]" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="commentModal" class="fixed inset-0 hidden items-center justify-center modal-overlay p-4">
        <div class="card p-6 rounded-2xl shadow-2xl w-full max-w-sm transform transition-all scale-100">
            <h3 class="text-lg font-bold mb-3">üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä</h3>
            <textarea id="commentInput" class="w-full p-3 border rounded-xl outline-none focus:ring-2 focus:ring-blue-500 resize-none bg-slate-50 dark:bg-slate-800" rows="3" placeholder="–í–≤–µ–¥—ñ—Ç—å –∑–∞–º—ñ—Ç–∫—É..."></textarea>
            <div class="flex justify-end gap-2 mt-4">
                <button class="px-4 py-2 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors font-medium" onclick="closeModal('commentModal')">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                <button id="saveCommentBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-bold shadow-lg shadow-blue-500/30">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </div>
        </div>
    </div>

    <div id="genericConfirmModal" class="fixed inset-0 hidden items-center justify-center modal-overlay p-4 z-[3000]">
        <div class="card p-6 rounded-2xl shadow-2xl w-full max-w-sm">
            <h3 class="text-xl font-bold mb-2 text-center" id="genericConfirmTitle">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è</h3>
            <p id="genericConfirmText" class="text-center mb-6 text-muted"></p>
            <div class="flex justify-center gap-3">
                <button id="genericConfirmCancel" class="px-5 py-2.5 bg-slate-100 dark:bg-slate-700 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-600 font-bold transition-colors">–ù—ñ</button>
                <button id="genericConfirmOk" class="px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold shadow-lg shadow-red-500/30 transition-colors">–¢–∞–∫</button>
            </div>
        </div>
    </div>

    <div id="confirmationModal" class="fixed inset-0 hidden items-center justify-center modal-overlay z-[2500] p-4">
        <div class="card p-6 rounded-2xl shadow-2xl w-full max-w-md flex flex-col max-h-[85vh]">
            <div class="text-center mb-4">
                <div class="w-12 h-12 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto mb-2 text-2xl">üì§</div>
                <h3 class="text-xl font-bold">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏</h3>
                <p class="text-sm text-muted">–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–≤–µ–¥–µ–Ω—ñ –¥–∞–Ω—ñ –ø–µ—Ä–µ–¥ –≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é</p>
            </div>
            
            <div class="bg-slate-50 dark:bg-slate-800 p-4 rounded-xl overflow-y-auto mb-4 border border-slate-200 dark:border-slate-700 text-xs sm:text-sm font-mono whitespace-pre-wrap flex-1 shadow-inner" id="confirmationText"></div>
            
            <p id="sendMsg" class="text-center text-sm font-bold mb-3 min-h-[1.25em] text-emerald-600"></p>
            
            <div id="modalActions" class="flex flex-col gap-2">
                <button id="confirmSendBtn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-emerald-500/30 transition-all active:scale-[0.98] flex items-center justify-center gap-2">
                    <span>‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ —Ç–∞ –ù–∞–¥—ñ—Å–ª–∞—Ç–∏</span>
                </button>
                <button onclick="closeModal('confirmationModal')" class="w-full bg-transparent border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 text-muted font-bold py-3.5 rounded-xl transition-colors">
                    –°–∫–∞—Å—É–≤–∞—Ç–∏
                </button>
            </div>
        </div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwb6BjHF4hMVfXe7lQBeFkTkvdeBSHXF1k3n3-DSg8SNflZla7LJPGoJtnKlb0Lx1eM-w/exec";

        const testingProducts = [
            "1101 –°–æ—î–≤–∏–π Bonsai", "1102 –°–æ—î–≤–∏–π Bonsai Prem", "1103 –°–æ—î–≤–∏–π YKI", "1104 –°–æ—î–≤–∏–π Bonsai Prof",
            "1105 –°–æ—î–≤–∏–π –ß—É–º–∞–∫", "1106 –°–æ—î–≤–∏–π METRO Chef", "1107 –¢–ê–ú–ê–†–ò Bonsai", "1108 –¢–µ—Ä—ñ—è–∫—ñ Bonsai",
            "1109 –£–ù–ê–ì–Ü Bonsai", "1110 –Ø–ö–Ü–¢–û–†–Ü Bonsai", "1111 –¢–µ—Ä—ñ—è–∫—ñ Bonsai Prem", "1112 –¢–µ—Ä—ñ—è–∫—ñ –≥—É—Å—Ç–∏–π YKI",
            "1113 –¢–µ—Ä—ñ—è–∫—ñ –∑ –º–µ–¥–æ–º Bonsai", "1114 –¢–µ—Ä—ñ—è–∫—ñ —Ä—ñ–¥–∫–∏–π YKI", "1115 –¢–µ—Ä—ñ—è–∫—ñ –ß—É–º–∞–∫", "1116 –î–ª—è –°—É—à–∏ Bonsai",
            "1117 –ë–∞–ª—å–∑–∞–º–∏–∫ Bonsai Prem", "1118 –ì–æ—Ä—ñ—Ö–æ–≤–∏–π Bonsai Prem", "1119 –°–æ—î–≤–∏–π Bonsai Prof (Custom Edition)", "1120 –î–ª—è –°—É—à–∏ Bonsai Prem",
            "1121 –°–æ—î–≤–∏–π (O)", "1122 –°–æ—î–≤–∏–π Ketjap", "1123 –£—Å—Ç—Ä–∏—á–Ω–∏–π Bonsai", "1124 –°–æ—î–≤–∏–π –°–æ–ª–æ–¥–∫–∏–π –¢–µ—Ä—ñ—è–∫—ñ",
            "1125 –°–æ—É—Å —Å–æ—î–≤–∏–π –¢–µ—Ä—ñ—è–∫—ñ SESAME & GINGER PERI PERI", "1126 –°–æ—É—Å —Å–æ—î–≤–∏–π –¢–µ—Ä—ñ—è–∫—ñ SWEET CHILI PERI PERI",
            "1127 –°–æ—É—Å —Å–æ—î–≤–∏–π –£–Ω–∞–≥—ñ SWEET & SOUR PERI PERI", "1128 –°–æ—É—Å —Å–æ—î–≤–∏–π SOY & WHEAT PERI PERI", "1129 –ú–∞—Ä–∏–Ω–∞–¥ —Å–æ—î–≤–∏–π ‚Ññ1",
            "1130 –ú–∞—Ä–∏–Ω–∞–¥ —Å–æ—î–≤–∏–π ‚Ññ7", "1131 –°–æ—É—Å –¢–µ—Ä—ñ—è–∫—ñ –î–æ–º—ñ–Ω–æ—Å", "1132 –°–æ—É—Å —Å–æ—î–≤–∏–π /(–°—É—à–∏ –¢–∞–π–º)", "1133 –°–æ—î–≤–∏–π –≥—É—Å—Ç–∏–π",
            "1134 –°–æ—É—Å —Å–æ—î–≤–∏–π_PL", "1201 –ö–∏—Å–ª–æ-—Å–æ–ª–æ–¥–∫–∏–π Peri Peri", "1202 –ì–æ—Å—Ç—Ä–æ-—Å–æ–ª–æ–¥–∫–∏–π Peri Peri", "1203 –ñ—É—Ä–∞–≤–ª–∏–Ω–Ω–∏–π Peri Peri",
            "1204 –û–∂–∏–Ω–æ–≤–∏–π Peri Peri", "1205 Hot Chili PL", "1206 Sweet Chili Peri Peri, Bonsai Prem", "1207 –ì—Ä–∞–Ω–∞—Ç–æ–≤–∏–π –ù–∞—Ä—à–∞—Ä–∞–± Peri Peri",
            "1208 –î–ª—è –õ–æ–∫—à–∏–Ω–∏WOK Peri Peri", "1209 –ñ–æ–≤—Ç–æ-–≥–∞—Ä—è—á–∏–π Peri Peri", "1210 –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ YKI", "1211 –ú–∞–Ω–≥–æ-–ß–∏–ª—ñ Peri Peri",
            "1212 –ü—Ä—è–Ω—ñ —Ç—Ä–∞–≤–∏ Peri Peri", "1213 –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ –ß—É–º–∞–∫", "1214 –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ Bonsai", "1216 –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ(SE) Bonsai Prem",
            "1217 Sweet Chili PL (PD)", "1218 Sweet Chili PL", "1219 –¢–∫–µ–º–∞–ª—ñ Peri Peri", "1220 –ö—ñ–º—á—ñ Premium", "1221 –°–∞—Ü–µ–±–µ–ª—ñ Peri Peri",
            "1301 –ê—Ä–∏–∑–æ–Ω–∞ –ë–∞—Ä–±–µ–∫—é Peri Peri", "1302 –ë–æ–ª–æ–Ω—å–µ–∑–µ Peri Peri", "1303 –ó –≤‚Äô—è–ª–µ–Ω–∏–º–∏ —Ç–æ–º–∞—Ç–∞–º–∏ Peri Peri", "1304 –ö–µ—Ç—á—É–ø Peri Peri",
            "1305 –ë–æ–ª–æ–Ω—å—î–∑–µ YKI", "1307 –î–ª—è –ü–Ü–¶–ò Bonsai Prof", "1308 –ö–µ—Ç—á—É–ø –õ–∞–≥—ñ–¥–Ω–∏–π YKI", "1310 –ö–µ—Ç—á—É–ø –ß—ñ–ª—ñ YKI",
            "1312 PL_–°–æ—É—Å –¢–æ–º–∞—Ç–Ω–∏–π (PD)", "1314 PL_–°–æ—É—Å ‚Ññ95 –¢–æ–º–∞—Ç–Ω–∏–π", "1315 PL_–¢–æ–º–∞—Ç–Ω–∞ –ø–∞—Å—Ç–∞ 1000 –≥—Ä", "1401 Original Salateria",
            "1402 –ë–∞–ª—å–∑–∞–º—ñ–∫–æ Fresh Salateria", "1403 –ó –∫—É–Ω–∂—É—Ç–Ω–æ—é –æ–ª—ñ—î—é Salateria", "1404 –ó –∫—É–Ω–∂—É—Ç–æ–º Salateria", "1405 –ú–µ–¥–æ–≤–æ-–≥—ñ—Ä—á–∏—á–Ω–∞ Fresh Salateria",
            "1501 –ö—É–Ω–∂—É—Ç–Ω–∏–π PP, BProf, Salat", "1502 –°–∏—Ä–Ω–∏–π Bonsai Prof", "1503 –¢–∞—Ä—Ç–∞—Ä Peri Peri", "1504 –¶–µ–∑–∞—Ä Peri Peri",
            "1505 –°–∏—Ä–Ω–∏–π Bonsai Prof, Peri Peri", "1506 –ü–ï–°–¢–û ROSSO", "1507 –ü–ï–°–¢–û", "1508 –ü–ï–°–¢–û PL", "1509 –ú–∞–π–æ–Ω–µ–∑ original 73%",
            "1510 PL_–í–µ—Ä—à–∫–æ–≤–∏–π (PD)", "1601 –ù–∞–ø–æ–≤–Ω—é–≤–∞—á –í–∏—à–Ω–µ–≤–∏–π PL", "1602 –ù–∞–ø–æ–≤–Ω—é–≤–∞—á –õ—ñ—Å–æ–≤–∞ —è–≥–æ–¥–∞ PL", "1701 –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç —è–±–ª—É—á–Ω–æ-–≥—Ä—É—à–µ–≤–∏–π",
            "1702 –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç —è–±–ª—É—á–Ω–æ-–≤–∏—à–Ω–µ–≤–∏–π", "1703 –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç —è–±–ª—É—á–Ω–æ-–º–∞–ª–∏–Ω–æ–≤–∏–π", "1704 –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç –∞–±—Ä–∏–∫–æ—Å–æ–≤–æ-–ø–µ—Ä—Å–∏–∫–æ–≤–∏–π",
            "1801 –í‚Äô—è–ª–µ–Ω—ñ —Ç–æ–º–∞—Ç–∏"
        ];

        const productDatabase = {
            "Bonsai": [
                {id: "3102", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 235 –º–ª"},
                {id: "3103", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 500 –º–ª"},
                {id: "3115", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π 750 –º–ª"},
                {id: "3104", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 890 –º–ª"},
                {id: "3101", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 1000 –º–ª (20531)"},
                {id: "3108", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü –∑ —á–∞—Å–Ω–∏–∫–æ–º —Ç–∞ –∏–º–±–∏—Ä–µ–º (–≥—É—Å—Ç–∏–π) 235 –º–ª"},
                {id: "3109", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –£–ù–ê–ì–Ü –∫–∏—Å–ª–æ-—Å–æ–ª–æ–¥–∫–∏–π (–ì—É—Å—Ç–∏–π) 240 –º–ª"},
                {id: "3105", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –î–õ–Ø –°–£–®–Ü –∑ –≤–æ–¥–æ—Ä–æ—Å—Ç—è–º–∏ –ö–û–ú–ë–£ 235 –º–ª"},
                {id: "3111", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –Ø–ö–Ü–¢–û–†–Ü –∑ —É—Å—Ç—Ä–∏—Ü—è–º–∏ —Ç–∞ –∫—É–Ω–∂—É—Ç–æ–º (–≥—É—Å—Ç–∏–π) 235 –º–ª"},
                {id: "3106", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ê–ú–ê–†–Ü –∑ –Ω–∞—Ç—É—Ä. –º–µ–¥–æ–º 235 –º–ª"},
                {id: "3112", name: "Bonsai —Å–æ—É—Å —Å–æ–ª–æ–¥–∫–∏–π –¢–µ—Ä—ñ—è–∫—ñ 235 –º–ª"},
                {id: "3113", name: "Bonsai —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ 260 –≥—Ä"},
                {id: "3110", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –£–ù–ê–ì–Ü –∫–∏—Å–ª–æ-—Å–æ–ª–æ–¥–∫–∏–π 500 –º–ª"},
                {id: "3116", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–µ—Ä—ñ—è–∫—ñ 500 –º–ª"},
                {id: "3107", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü –∑ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏–º –º–µ–¥–æ–º 500 –º–ª"},
                {id: "3114", name: "Bonsai —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ 550 –≥—Ä"},
                {id: "3120", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π (–≥—É—Å—Ç–∏–π) –¥–æ–π-–ø–∞–∫ 200 –≥—Ä"},
                {id: "3117", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü –∑ —á–∞—Å–Ω–∏–∫–æ–º —Ç–∞ –∏–º–±–∏—Ä–µ–º (–≥—É—Å—Ç–∏–π) –¥–æ–π-–ø–∞–∫ 200 –≥—Ä"},
                {id: "3119", name: "Bonsai —Å–æ—É—Å —Å–æ—î–≤–∏–π –£–ù–ê–ì–Ü –∫–∏—Å–ª–æ-—Å–æ–ª–æ–¥–∫–∏–π (–≥—É—Å—Ç–∏–π) –¥–æ–π-–ø–∞–∫ 200 –≥—Ä"},
                {id: "3118", name: "Bonsai —Å–æ—É—Å —Å–æ–ª–æ–¥–∫–∏–π –¢–µ—Ä—ñ—è–∫—ñ (–≥—É—Å—Ç–∏–π) –¥–æ–π-–ø–∞–∫ 200 –≥—Ä"},
                {id: "3121", name: "Bonsai —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ (–≥—É—Å—Ç–∏–π) –¥–æ–π-–ø–∞–∫ 200–≥—Ä"}
            ],
            "Bonsai Premium": [
                {id: "3202", name: "Bonsai Premium —Å–æ—É—Å c–æ—î–≤–∏–π Ketjap Manis 570 –≥"},
                {id: "3201", name: "Bonsai Premium —Å–æ—É—Å c–æ—î–≤–∏–π –ë–∞–ª—å–∑–∞–º—ñ—á–Ω–∏–π 250 –º–ª"},
                {id: "3203", name: "Bonsai Premium —Å–æ—É—Å c–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 1000 –º–ª"},
                {id: "3211", name: "Bonsai Premium —Å–æ—É—Å c–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 20 –ª"},
                {id: "3204", name: "Bonsai Premium —Å–æ—É—Å c–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 250 –º–ª"},
                {id: "3205", name: "Bonsai Premium —Å–æ—É—Å c–æ—î–≤–∏–π –¢–µ—Ä—ñ—è–∫—ñ 250 –º–ª"},
                {id: "3206", name: "Bonsai Premium —Å–æ—É—Å –ì–û–†–Ü–•–û–í–ò–ô 500 –≥—Ä"},
                {id: "3207", name: "Bonsai Premium —Å–æ—É—Å –ì—Ä–∞–Ω–∞—Ç–æ–≤–∏–π (–ù–ê–†–®–ê–†–ê–ë) 350–≥—Ä"},
                {id: "3209", name: "Bonsai Premium —Å–æ—É—Å –ù–ê–†–®–ê–†–ê–ë 1300 –≥—Ä"},
                {id: "3208", name: "Bonsai Premium —Å–æ—É—Å —Å–æ–ª–æ–¥–∫–∏–π —á–∏–ª—ñ 1100 –≥—Ä"}
            ],
            "Bonsai Professional": [
                {id: "3305", name: "Bonsai professional —Å–æ—É—Å –ë–û–õ–û–ù–¨–Ñ–ó–ï (–Ü—Ç–∞–ª. –∫—É—Ö–Ω—è) 1000 –º–ª"},
                {id: "3301", name: "Bonsai professional —Å–æ—É—Å –ì–û–°–¢–†–û-–°–û–õ–û–î–ö–ò–ô (–ö–∏—Ç–∞–π. –∫—É—Ö–Ω—è) 1000 –º–ª"},
                {id: "3307", name: "Bonsai professional —Å–æ—É—Å –î–ª—è –ø—ñ—Ü–∏ 1000 –≥—Ä"},
                {id: "3308", name: "Bonsai professional —Å–æ—É—Å –ö–ò–°–õ–û-–°–û–õ–û–î–ö–ò–ô (–ö–∏—Ç–∞–π. –∫—É—Ö–Ω—è) 1000 –º–ª"},
                {id: "3309", name: "Bonsai professional —Å–æ—É—Å –ö—ñ–º—á—ñ 1100 –≥—Ä"},
                {id: "3310", name: "Bonsai professional —Å–æ—É—Å –ö–£–ù–ñ–£–¢–ù–ò–ô (–≥—É—Å—Ç–∏–π) 1000 –º–ª"},
                {id: "3311", name: "Bonsai professional —Å–æ—É—Å –°–∏—Ä–Ω–∏–π 1 –∫–≥/–≤—ñ–¥—Ä–æ"},
                {id: "3312", name: "Bonsai professional —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π 1000 –º–ª (–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 1:1)"},
                {id: "3313", name: "Bonsai professional —Å–æ—É—Å —Å–æ—î–≤–∏–π –∫–ª–∞—Å–∏—á–Ω–∏–π 5000 –º–ª –ü–ï–¢ (–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 1:1)"},
                {id: "3314", name: "Bonsai professional —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π –∫–∞–Ω—ñ—Å—Ç—Ä–∞ 20 –ª New"},
                {id: "3315", name: "Bonsai professional —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü (–≥—É—Å—Ç–∏–π) 1000 –º–ª"},
                {id: "3316", name: "Bonsai professional —Å–æ—É—Å —Å–æ—î–≤–∏–π –Ø–ö–Ü–¢–û–†–Ü (–≥—É—Å—Ç–∏–π) 1000 –º–ª"},
                {id: "3317", name: "Bonsai professional —Å–æ—É—Å —Å–æ–ª–æ–¥–∫–∏–π –¢–ï–†–Ü–Ø–ö–Ü (–≥—É—Å—Ç–∏–π) 1000 –º–ª"},
                {id: "3318", name: "Bonsai professional —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ 5700 –≥—Ä –ü–ï–¢"},
                {id: "3319", name: "Bonsai professional —Å–æ—É—Å –£–ù–ê–ì–Ü (–≥—É—Å—Ç–∏–π) 1000 –º–ª"},
                {id: "3320", name: "Bonsai professional –°–æ—É—Å –£–°–¢–†–ò–ß–ù–ò–ô (–≥—É—Å—Ç–∏–π) 1000 –º–ª"}
            ],
            "Peri Peri": [
                {id: "3401", name: "Peri Peri —Å–æ—É—Å –ê—Ä–∏–∑–æ–Ω–∞ BBQ (–ê–º–µ—Ä–∏–∫–∞–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3402", name: "Peri Peri —Å–æ—É—Å –ë–æ–ª–æ–Ω—å—î–∑–µ (–Ü—Ç–∞–ª.–∫—É—Ö–Ω—è) 310 –≥"},
                {id: "3403", name: "Peri Peri —Å–æ—É—Å –ì–æ—Å—Ç—Ä–æ-—Å–æ–ª–æ–¥–∫–∏–π (–ö–∏—Ç–∞–π.–∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3404", name: "Peri Peri —Å–æ—É—Å –ì—Ä–∞–Ω–∞—Ç–æ–≤–∏–π (–ù–ê–†–®–ê–†–ê–ë) 255 –≥"},
                {id: "3405", name: "Peri Peri —Å–æ—É—Å –¥–ª—è –õ–æ–∫—à–∏–Ω–∏ WOK (–ö–∞–Ω—Ç–æ–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3425", name: "Peri Peri —Å–æ—É—Å –ñ–æ–≤—Ç–æ-–≥–∞—Ä—è—á–∏–π (–¢–∞–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 310 –≥"},
                {id: "3426", name: "Peri Peri —Å–æ—É—Å –ñ—É—Ä–∞–≤–ª–∏–Ω–Ω–∏–π (–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 330 –≥"},
                {id: "3406", name: "Peri Peri —Å–æ—É—Å –ó –≤‚Äô—è–ª–µ–Ω–∏–º–∏ —Ç–æ–º–∞—Ç–∞–º–∏ (–Ü—Ç–∞–ª—ñ–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 310 –≥"},
                {id: "3407", name: "Peri Peri —Å–æ—É—Å –ö–µ—Ç—á—É–ø (–ê–º–µ—Ä–∏–∫–∞–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3408", name: "Peri Peri —Å–æ—É—Å –ö–∏—Å–ª–æ-—Å–æ–ª–æ–¥–∫–∏–π (–ö–∏—Ç–∞–π.–∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3409", name: "Peri Peri —Å–æ—É—Å –ö—É–Ω–∂—É—Ç–Ω–∏–π (–Ø–ø–æ–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 310 –≥"},
                {id: "3410", name: "Peri Peri —Å–æ—É—Å –ú–∞–Ω–≥–æ-–ß–∏–ª—ñ (–¢–∞–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3411", name: "Peri Peri —Å–æ—É—Å –û–∂–∏–Ω–æ–≤–∏–π –∑ –ø–µ—Ä—Ü–µ–º –•–∞–ª–∞–ø–µ–Ω—å–π–æ (–ú–µ–∫—Å–∏–∫–∞–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 330 –≥"},
                {id: "3424", name: "Peri Peri —Å–æ—É—Å –¶–µ–∑–∞—Ä (–ê–º–µ—Ä–∏–∫–∞–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 300 –≥"},
                {id: "3422", name: "Peri Peri —Å–æ—É—Å –¢–∫–µ–º–∞–ª—ñ (–ì—Ä—É–∑–∏–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3414", name: "Peri Peri —Å–æ—É—Å –ü—Ä—è–Ω—ñ —Ç—Ä–∞–≤–∏ (–Ü—Ç–∞–ª—ñ–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 310 –≥"},
                {id: "3415", name: "Peri Peri —Å–æ—É—Å –°–∞—Ü–µ–±–µ–ª—ñ (–ì—Ä—É–∑–∏–Ω—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3418", name: "Peri Peri —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π-–ß–∏–ª—ñ (–¢–∞–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 320 –≥"},
                {id: "3419", name: "Peri Peri —Å–æ—É—Å –¢–ê–†–¢–ê–† (–§—Ä–∞–Ω—Ü—É–∑—å–∫–∞ –∫—É—Ö–Ω—è) 280 –≥"},
                {id: "3420", name: "Peri Peri —Å–æ—É—Å –¢–ï–†–Ü–Ø–ö–Ü sesame & ginger 180 –º–ª"},
                {id: "3421", name: "Peri Peri —Å–æ—É—Å –¢–ï–†–Ü–Ø–ö–Ü sweet chili 180 –º–ª"},
                {id: "3417", name: "Peri Peri —Å–æ—É—Å —Å–æ—î–≤–∏–π soy & wheat 180 –º–ª"},
                {id: "3423", name: "Peri Peri —Å–æ—É—Å –£–ù–ê–ì–Ü sweet & sour 180 –º–ª"},
                {id: "3412", name: "Peri Peri —Å–æ—É—Å –ü–ï–°–¢–û 200 –≥"},
                {id: "3413", name: "Peri Peri —Å–æ—É—Å –ü–ï–°–¢–û ROSSO 200 –≥"}
            ],
            "6 –õ–Ü–¢–†–Ü–í": [
                {id: "1", name: "6 –õ–Ü–¢–†–Ü–í –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç –∞–±—Ä–∏–∫–æ—Å–æ–≤–æ-–ø–µ—Ä—Å–∏–∫–æ–≤–∏–π 1000 –º–ª"},
                {id: "2", name: "6 –õ–Ü–¢–†–Ü–í –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç —è–±–ª—É—á–Ω–æ-–≤–∏—à–Ω–µ–≤–∏–π 1000 –º–ª"},
                {id: "3", name: "6 –õ–Ü–¢–†–Ü–í –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç —è–±–ª—É—á–Ω–æ-–≥—Ä—É—à–µ–≤–∏–π 1000 –º–ª"},
                {id: "4", name: "6 –õ–Ü–¢–†–Ü–í –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ—Ç —è–±–ª—É—á–Ω–æ-–º–∞–ª–∏–Ω–æ–≤–∏–π 1000 –º–ª"}
            ],
            "Salateria": [
                {id: "31001", name: "Salateria Fresh –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ –ú–µ–¥–æ–≤–æ-–ì—ñ—Ä—á–∏—á–Ω–∞ 335 –≥"},
                {id: "31002", name: "Salateria Fresh –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ –¶–µ–∑–∞—Ä 320 –≥"},
                {id: "31003", name: "Salateria Fresh –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ –ë–∞–ª—å–∑–∞–º—ñ–∫–æ 335 –≥"},
                {id: "3501", name: "Salateria –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ Original 360 –≥"},
                {id: "3502", name: "Salateria –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ –±–∞–ª—å–∑–∞–º—ñ—á–Ω–∞ 360 –≥"},
                {id: "3503", name: "Salateria –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ –ö–£–ù–ñ–£–¢–ù–ê 320 –≥"},
                {id: "3504", name: "Salateria –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ —Å–æ—î–≤–∞ –∑ –∫—É–Ω–∂—É—Ç–Ω–æ—é –æ–ª—ñ—î—é 360 –≥"},
                {id: "3505", name: "Salateria –°–∞–ª–∞—Ç–Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–∞ —Å–æ—î–≤–∞ –∑ –∫—É–Ω–∂—É—Ç–æ–º 360 –≥"}
            ],
            "Special Edition": [
                {id: "3141", name: "SOY SAUCE —Å–æ—É—Å —Å–æ—î–≤–∏–π –ö–ª–∞—Å–∏—á–Ω–∏–π special edition 1000 –º–ª"}
            ],
            "YKI": [
                {id: "3601", name: "YKI —Å–æ—É—Å c–æ—î–≤–∏–π 1000 –º–ª"},
                {id: "3602", name: "YKI —Å–æ—É—Å c–æ—î–≤–∏–π 205 –º–ª"},
                {id: "3603", name: "YKI —Å–æ—É—Å c–æ—î–≤–∏–π 470 –º–ª"},
                {id: "3604", name: "YKI —Å–æ—É—Å c–æ—î–≤–∏–π 890 –º–ª"},
                {id: "3605", name: "YKI —Å–æ—É—Å –ë–æ–ª–æ–Ω—å—î–∑–µ (–Ü—Ç–∞–ª—ñ–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 220 –≥—Ä"},
                {id: "3606", name: "YKI —Å–æ—É—Å –ë–æ–ª–æ–Ω—å—î–∑–µ (–Ü—Ç–∞–ª—ñ–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 530 –≥—Ä"},
                {id: "3607", name: "YKI —Å–æ—É—Å –ì–æ—Å—Ç—Ä–æ-—Å–æ–ª–æ–¥–∫–∏–π (–ö–∏—Ç–∞–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 525 –≥—Ä"},
                {id: "3608", name: "YKI —Å–æ—É—Å –ö–∏—Å–ª–æ-—Å–æ–ª–æ–¥–∫–∏–π (–ö–∏—Ç–∞–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 525 –≥—Ä"},
                {id: "3609", name: "YKI —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü (–≥—É—Å—Ç–∏–π) 205 –º–ª"},
                {id: "3610", name: "YKI —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü 205 –º–ª"},
                {id: "3611", name: "YKI —Å–æ—É—Å —Å–æ—î–≤–∏–π –¢–ï–†–Ü–Ø–ö–Ü –∑ —á–∞—Å–Ω–∏–∫–æ–º —Ç–∞ —ñ–º–±–∏—Ä–æ–º (–≥—É—Å—Ç–∏–π) 470 –º–ª"},
                {id: "3612", name: "YKI —Å–æ—É—Å —Å–æ—î–≤–∏–π –£–ù–ê–ì–Ü 205 –º–ª"},
                {id: "3614", name: "YKI —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π –ß–∏–ª—ñ 225 –≥—Ä"},
                {id: "3613", name: "YKI —Å–æ—É—Å –°–æ–ª–æ–¥–∫–∏–π-–ß–∏–ª—ñ (–¢–∞–π—Å—å–∫–∞ –∫—É—Ö–Ω—è) 540 –≥—Ä"}
            ]
        };

        const checklistItems = {
            start: [
                { id: 'start-1-1', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏—Å—Ç–æ—Ç—É —Ç–∞ —Å–ø—Ä–∞–≤–Ω—ñ—Å—Ç—å –≤–∞–≥ —ñ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—ó.', type: 'normal' },
                { id: 'start-1-2', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –æ—Ö–æ–ª–æ–¥–∂–µ–Ω–Ω—è –Ω—ñ—á–Ω–∏—Ö –≤–∞—Ä–æ–∫ (t ‚â§ 24¬∞C).', type: 'problem', btn: '‚ö†Ô∏è –í—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è', fields: ['‚Ññ –ö–æ—Ç–ª–∞', '‚Ññ –ó–∞–≤–¥–∞–Ω–Ω—è', '–°–æ—É—Å', '–¢–µ–º–ø ¬∞C'] },
                { id: 'start-1-3', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —è–∫—ñ—Å—Ç—å –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –≤–∞—Ä–æ–∫ (—Ñ—ñ–∑-—Ö—ñ–º —Ç–∞ –æ—Ä–≥–∞–Ω–æ–ª–µ–ø—Ç–∏–∫–∞).', type: 'problem', btn: '‚õî –ù–ï–î–û–ü–£–°–ö', fields: ['‚Ññ –ó–∞–≤–¥–∞–Ω–Ω—è', '–°–æ—É—Å', '–ü—Ä–∏—á–∏–Ω–∞'] },
                { id: 'start-1-4', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∂—É—Ä–Ω–∞–ª –∑–∞–º—ñ–Ω–∏ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤.', type: 'normal' },
                { id: 'start-1-5', text: '–í–∏–¥–∞—Ç–∏ –∫–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç–∏ –≤–∞—Ä–Ω–∏–∫–∞–º –ø—ñ–¥ –ø—ñ–¥–ø–∏—Å.', type: 'info', btn: 'üìù –ó–∞–ø–∏—Å–∞—Ç–∏', fields: ['–í–∞—Ä–Ω–∏–∫ (–ü–Ü–ë)', '–ö–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç', '–ö—ñ–ª—å–∫—ñ—Å—Ç—å'] },
            ],
            during: [
                { id: 'during-1-1', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≥—ñ–≥—ñ—î–Ω—É –ø–µ—Ä—Å–æ–Ω–∞–ª—É (–æ–¥—è–≥, —à–∞–ø–æ—á–∫–∏, –ø—Ä–∏–∫—Ä–∞—Å–∏).', type: 'normal' },
                { id: 'during-1-2', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É —Å–∏—Ä–æ–≤–∏–Ω–∏ –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å.', type: 'normal' },
                { id: 'during-1-3', text: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –µ–∫—Å–ø—Ä–µ—Å-—Ç–µ—Å—Ç –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –≤–æ–¥–æ–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ (–•–í–û).', type: 'problem', btn: '‚ö†Ô∏è –í—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è', fields: ['–ü–æ–∫–∞–∑–Ω–∏–∫', '–ó–Ω–∞—á–µ–Ω–Ω—è'] },
                { id: 'during-1-4', text: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –±–µ–∑–ø–µ—á–Ω–æ—Å—Ç—ñ –ø—Ä–æ—Ü–µ—Å—É.', type: 'problem', btn: '‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞', fields: ['–û–ø–∏—Å –ø–æ—Ä—É—à–µ–Ω–Ω—è'] },
                { id: 'during-1-5', text: '–í–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞.', type: 'normal' },
            ],
            end: [
                { id: 'end-1-1', text: '–ü—Ä–æ–≤–µ—Å—Ç–∏ –∑–∞–º—ñ—Ä–∏ –¥–ª—è –í–°–Ü–• –≤–∞—Ä–æ–∫ –ø–µ—Ä–µ–¥ –æ—Ö–æ–ª–æ–¥–∂–µ–Ω–Ω—è–º.', type: 'normal' },
                { id: 'end-1-2', text: '–ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –∑–∞–ª–∏—à–∫–∏ –∫–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç—ñ–≤ —Ç–∞ –¢–ú–¶ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—é.', type: 'normal' },
                { id: 'end-1-3', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–∞–Ω—ñ—Ç–∞—Ä–Ω–∏–π —Å—Ç–∞–Ω —Ü–µ—Ö—É.', type: 'problem', btn: '‚ö†Ô∏è –ù–µ–∑–∞–¥–æ–≤—ñ–ª—å–Ω–æ', fields: ['–û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏/–¥—ñ–ª—å–Ω–∏—Ü—è'] },
                { id: 'end-1-4', text: '–ó–∞–ø–æ–≤–Ω–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –Ω–µ–¥–æ–ª—ñ–∫–∏ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–º—ñ–Ω–∏.', type: 'normal' },
                { id: 'end-1-5', text: '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å —Å–∫–ª–∞ —Ç–∞ –ø–ª–∞—Å—Ç–∏–∫—É (–≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –±–æ—é).', type: 'normal' },
            ]
        };

        const employees = ["–°–æ–±–æ—Ç–æ–≤–∏—á –õ.–ú.", "–û–≥–∞—Ä–∫–æ–≤–∞ –ú.–í.", "–Ü–Ω—à–∏–π"];
        let currentJournalTab = 'testing';
        let currentChecklistTab = 'start';
        let activeCommentId = null;
        let pendingReportData = null;
        let confirmCallback = null;

        document.addEventListener('DOMContentLoaded', () => {
            initApp();
        });

        // --- CUSTOM TOAST & CONFIRM ---
        function showToast(message, isError = false) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast bg-white dark:bg-slate-700 border-l-4 p-4 rounded-lg shadow-xl flex items-center max-w-sm transform transition-all duration-300 translate-x-full border border-slate-200 dark:border-slate-600`;
            if (isError) {
                toast.classList.add('border-red-500', 'text-red-700', 'dark:text-red-400');
                toast.innerHTML = `<span class="mr-2 text-xl">üö´</span> <span class="font-medium text-sm">${message}</span>`;
            } else {
                toast.classList.add('border-emerald-500', 'text-emerald-700', 'dark:text-emerald-400');
                toast.innerHTML = `<span class="mr-2 text-xl">‚úÖ</span> <span class="font-medium text-sm">${message}</span>`;
            }
            
            container.appendChild(toast);
            
            // Trigger animation
            requestAnimationFrame(() => {
                toast.classList.remove('translate-x-full');
            });

            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function customConfirm(text, onConfirm) {
            document.getElementById('genericConfirmText').innerText = text;
            document.getElementById('genericConfirmModal').classList.remove('hidden');
            document.getElementById('genericConfirmModal').classList.add('flex');
            confirmCallback = onConfirm;
        }

        document.getElementById('genericConfirmCancel').addEventListener('click', () => {
            document.getElementById('genericConfirmModal').classList.add('hidden');
            document.getElementById('genericConfirmModal').classList.remove('flex');
            confirmCallback = null;
        });

        document.getElementById('genericConfirmOk').addEventListener('click', () => {
            if(confirmCallback) confirmCallback();
            document.getElementById('genericConfirmModal').classList.add('hidden');
            document.getElementById('genericConfirmModal').classList.remove('flex');
            confirmCallback = null;
        });

        // Theme Toggle
        document.getElementById('themeToggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        function initApp() {
            // Restore theme
            if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            }

            const sel = document.getElementById('employeeSelect');
            employees.forEach(e => sel.add(new Option(e, e)));

            const now = new Date();
            const options = { weekday: 'short', day: '2-digit', month: '2-digit', year: 'numeric' };
            const dateStr = new Intl.DateTimeFormat('uk-UA', options).format(now);
            document.getElementById('current-date').innerText = dateStr.charAt(0).toUpperCase() + dateStr.slice(1);
            
            document.getElementById('lbl-time').value = now.toLocaleTimeString('uk-UA', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('tst-time').value = now.toLocaleTimeString('uk-UA', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('tst-cookDate').valueAsDate = now;
            document.getElementById('lbl-label-date').valueAsDate = now;

            const tmSelect = document.getElementById('lbl-tm');
            
            Object.keys(productDatabase).forEach(tm => {
                tmSelect.add(new Option(tm, tm));
            });

            tmSelect.addEventListener('change', (e) => {
                updateProductList(e.target.value);
            });

            const tstList = document.getElementById('tst-product-list');
            testingProducts.forEach(prod => {
                const option = document.createElement('option');
                option.value = prod;
                tstList.appendChild(option);
            });

            const batchInput = document.getElementById('lbl-label-batch');
            batchInput.addEventListener('blur', function() {
                if(this.value && !this.value.trim().toUpperCase().startsWith('L')) {
                    this.value = 'L' + this.value.trim();
                    saveState(); 
                }
            });

            renderChecklist('start');
            renderChecklist('during');
            renderChecklist('end');

            loadState();
            
            document.body.addEventListener('click', handleClick);
            document.body.addEventListener('change', handleInput);
            
            document.querySelectorAll('.journal-checkbox').forEach(cb => {
                cb.addEventListener('click', (e) => {
                    const emp = document.getElementById('employeeSelect').value;
                    if(!emp) {
                        e.preventDefault();
                        showToast("‚ö†Ô∏è –û–±–µ—Ä—ñ—Ç—å —ñ–º'—è –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞!", true);
                    }
                });
            });

            switchJournalTab(currentJournalTab);
        }

        function updateProductList(tm) {
            const list = document.getElementById('lbl-product-list');
            const input = document.getElementById('lbl-product');
            
            list.innerHTML = '';
            input.value = '';

            if (tm && productDatabase[tm]) {
                input.disabled = false;
                input.placeholder = "–í–≤–µ–¥—ñ—Ç—å –∞—Ä—Ç–∏–∫—É–ª –∞–±–æ –Ω–∞–∑–≤—É...";
                productDatabase[tm].forEach(p => {
                    const option = document.createElement('option');
                    option.value = `${p.id} | ${p.name}`;
                    list.appendChild(option);
                });
            } else {
                input.disabled = true;
                input.placeholder = "–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –¢–ú...";
            }
        }

        function renderChecklist(section) {
            const ul = document.getElementById(`list-${section}`);
            ul.innerHTML = checklistItems[section].map(item => {
                let actionBtn = `<button class="action-btn ml-2 p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors text-muted" data-id="${item.id}" data-type="comment" title="–ö–æ–º–µ–Ω—Ç–∞—Ä"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg></button>`;
                let formHtml = '';

                if (item.type !== 'normal') {
                    const btnClass = item.type === 'info' ? 'bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300' : 'bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300';
                    actionBtn = `<button class="action-btn ml-2 px-3 py-1 rounded-lg text-xs font-bold flex items-center gap-1 ${btnClass} transition-colors hover:opacity-80" data-id="${item.id}" data-type="form">${item.btn}</button>`;
                    
                    const inputs = item.fields.map((f, i) => `<input type="text" data-field="${i}" class="w-full p-2 border rounded-lg text-sm mb-2" placeholder="${f}">`).join('');
                    formHtml = `<div id="form-${item.id}" class="hidden mt-3 p-4 border rounded-xl bg-white dark:bg-slate-800 dark:border-slate-700 shadow-inner"><div class="text-xs font-bold mb-2 text-muted uppercase">${item.btn}</div>${inputs}<div class="flex justify-end gap-2 mt-2"><button class="form-cancel px-3 py-1.5 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg text-xs font-bold text-muted hover:bg-slate-100 dark:hover:bg-slate-700" data-id="${item.id}">–°–∫–∞—Å—É–≤–∞—Ç–∏</button><button class="form-save px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-bold hover:bg-blue-700" data-id="${item.id}">–ó–±–µ—Ä–µ–≥—Ç–∏</button></div></div>`;
                }
                
                return `
                <li id="${item.id}" class="checklist-item p-3 sm:p-4 rounded-xl flex flex-col cursor-pointer select-none">
                    <div class="flex items-center justify-between w-full">
                        <div class="flex items-center flex-1 check-trigger" data-id="${item.id}">
                            <div class="checkbox-icon mr-3 sm:mr-4"></div>
                            <span class="task-text text-sm sm:text-base font-medium">${item.text}</span>
                        </div>
                        ${actionBtn}
                    </div>
                    ${formHtml}
                    <div class="comment-text hidden"></div>
                </li>`;
            }).join('');
        }

        function handleClick(e) {
            if (e.target.closest('.nav-button')) {
                const view = e.target.closest('.nav-button').dataset.view;
                switchView(view);
            }
            if (e.target.id === 'resetStartBtn') resetSection('startShiftSection');
            if (e.target.id === 'resetDuringBtn') resetSection('duringShiftSection');
            if (e.target.id === 'resetEndBtn') resetSection('endShiftSection');
            if (e.target.id === 'resetJournalBtn') resetSection('journalSection');

            if (e.target.closest('.check-trigger')) {
                if (!validateEmployee()) return;
                const id = e.target.closest('.check-trigger').dataset.id;
                toggleItem(id);
            }

            if (e.target.closest('.action-btn')) {
                e.stopPropagation();
                if (!validateEmployee()) return;
                const btn = e.target.closest('.action-btn');
                const id = btn.dataset.id;
                if (btn.dataset.type === 'form') {
                    document.getElementById(`form-${id}`).classList.toggle('hidden');
                } else {
                    activeCommentId = id;
                    document.getElementById('commentInput').value = document.querySelector(`#${id} .comment-text`).innerText;
                    const modal = document.getElementById('commentModal');
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                }
            }

            if (e.target.classList.contains('form-cancel')) document.getElementById(`form-${e.target.dataset.id}`).classList.add('hidden');
            if (e.target.classList.contains('form-save')) saveForm(e.target.dataset.id);
            if (e.target.classList.contains('journal-tab')) switchJournalTab(e.target.dataset.jtab);
            if (e.target.id === 'submitJournalBtn') prepareJournalReport();
            if (e.target.id === 'saveCommentBtn') saveComment();
            if (e.target.id === 'confirmSendBtn') executeSend();
        }

        function handleInput(e) {
            if (['INPUT', 'SELECT', 'TEXTAREA'].includes(e.target.tagName)) {
                saveState();
            }
        }

        function validateEmployee() {
            const select = document.getElementById('employeeSelect');
            if (!select.value) {
                showToast("–û–±–µ—Ä—ñ—Ç—å —ñ–º'—è –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞!", true);
                document.getElementById('employeeSelectionHint').classList.remove('hidden');
                select.focus();
                return false;
            }
            document.getElementById('employeeSelectionHint').classList.add('hidden');
            return true;
        }

        function toggleItem(id) {
            const el = document.getElementById(id);
            el.classList.toggle('completed');
            if (el.classList.contains('completed')) {
                el.classList.remove('has-problem', 'has-info');
                const c = el.querySelector('.comment-text');
                c.innerText = ''; c.classList.add('hidden', 'alert', 'info');
                const f = document.getElementById(`form-${id}`);
                if(f) f.classList.add('hidden');
            }
            saveState();
            updateProgress();
        }

        function saveForm(id) {
            const form = document.getElementById(`form-${id}`);
            const inputs = form.querySelectorAll('input');
            const vals = Array.from(inputs).map(i => i.value);
            if (vals.some(v => !v)) { showToast("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è!", true); return; }
            
            const item = document.getElementById(id);
            const isInfo = item.innerHTML.includes('text-blue-700'); // Check based on class logic
            const c = item.querySelector('.comment-text');
            c.innerText = vals.join(' | ');
            c.classList.remove('hidden', 'alert', 'info');
            c.classList.add(isInfo ? 'info' : 'alert');
            
            item.classList.remove('has-problem', 'has-info');
            item.classList.add(isInfo ? 'has-info' : 'has-problem');
            item.classList.add('completed');
            
            form.classList.add('hidden');
            saveState();
            updateProgress();
        }

        function saveComment() {
            const txt = document.getElementById('commentInput').value;
            const item = document.getElementById(activeCommentId);
            const c = item.querySelector('.comment-text');
            c.innerText = txt;
            if(txt) { 
                c.classList.remove('hidden'); 
                item.classList.add('has-info'); 
            } else { 
                c.classList.add('hidden'); 
                item.classList.remove('has-info'); 
            }
            closeModal('commentModal');
            saveState();
        }

        function updateProgress() {
            if (['journal', 'contacts'].includes(currentChecklistTab)) {
                document.getElementById('footerStatus').style.display = 'none';
                return;
            }
            document.getElementById('footerStatus').style.display = 'flex';
            
            const list = document.getElementById(`list-${currentChecklistTab}`);
            const total = list.children.length;
            const done = list.querySelectorAll('.completed').length;
            const percent = total > 0 ? (done/total)*100 : 0;
            
            document.getElementById('progressBar').style.width = `${percent}%`;
            document.getElementById('progressText').innerText = `${done}/${total} –∑–∞–≤–¥–∞–Ω—å`;
            
            if (total > 0 && done === total) prepareChecklistReport(currentChecklistTab);
        }

        function switchView(view) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            
            if (view === 'journal') {
                document.getElementById('journalSection').classList.remove('hidden');
                document.querySelector('[data-view="journal"]').classList.add('active');
                currentChecklistTab = 'journal';
                switchJournalTab(currentJournalTab);
            } else {
                document.getElementById(`${view}ShiftSection`).classList.remove('hidden');
                document.querySelector(`[data-view="${view}"]`).classList.add('active');
                currentChecklistTab = view;
            }
            updateProgress();
        }

        function switchJournalTab(tab) {
            currentJournalTab = tab;
            document.querySelectorAll('.journal-tab').forEach(b => b.classList.remove('active'));
            document.querySelector(`[data-jtab="${tab}"]`).classList.add('active');
            
            document.getElementById('form-labeling').classList.add('hidden');
            document.getElementById('form-testing').classList.add('hidden');
            document.getElementById(`form-${tab}`).classList.remove('hidden');
        }

        function resetSection(sectionId) {
            customConfirm('–í–∏ –¥—ñ–π—Å–Ω–æ –±–∞–∂–∞—î—Ç–µ –æ—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –ø–æ–ª—è –≤ —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ?', () => {
                const section = document.getElementById(sectionId);
                
                if(sectionId === 'journalSection') {
                    section.querySelectorAll('input:not([type="time"]), textarea, select').forEach(el => {
                        if(el.type === 'checkbox') el.checked = false;
                        else el.value = '';
                    });
                } else {
                    section.querySelectorAll('.checklist-item').forEach(el => {
                        el.classList.remove('completed', 'has-problem', 'has-info');
                        const c = el.querySelector('.comment-text');
                        if(c) { c.innerText = ''; c.classList.add('hidden', 'alert', 'info'); }
                        el.querySelectorAll('input').forEach(i => i.value = '');
                        const f = el.querySelector('[id^="form-"]');
                        if(f) f.classList.add('hidden');
                    });
                }
                saveState();
                updateProgress();
                showToast("–†–æ–∑–¥—ñ–ª —É—Å–ø—ñ—à–Ω–æ –æ—á–∏—â–µ–Ω–æ");
            });
        }

        function prepareJournalReport() {
            if(!validateEmployee()) return;
            
            let report = "", sectionName = "";
            if (currentJournalTab === 'labeling') {
                sectionName = "–ñ—É—Ä–Ω–∞–ª: –ï—Ç–∏–∫–µ—Ç—É–≤–∞–Ω–Ω—è";
                const tm = document.getElementById('lbl-tm').value;
                report = `–ß–∞—Å: ${document.getElementById('lbl-time').value}\n–ú–∞—à–∏–Ω–∞: ${document.getElementById('lbl-machine').value}\n–¢–ú: ${tm}\n–ü—Ä–æ–¥—É–∫—Ç: ${document.getElementById('lbl-product').value}\n–ó–∞–≤–¥–∞–Ω–Ω—è: ${document.getElementById('lbl-task').value}\n–°–∞–Ω.—Å—Ç–∞–Ω: ${document.getElementById('lbl-sanitary').value}\n–î–∞—Ç–∞ –µ—Ç–∏–∫–µ—Ç–∫–∏: ${document.getElementById('lbl-label-date').value}\n–ü–∞—Ä—Ç—ñ—è: ${document.getElementById('lbl-label-batch').value}\n–ü–ª—ñ–≤–∫–∞: ${document.getElementById('lbl-width').value}\n–¢–µ–º–ø: ${document.getElementById('lbl-temp').value}\n–ü–∞–∫: ${document.getElementById('check-pack').checked ? '+' : '-'}\n–°—Ç—ñ–∫–µ—Ä: ${document.getElementById('check-sticker').checked ? '+' : '-'}\n–ü–∞–ª–µ—Ç–∞: ${document.getElementById('check-pallet').checked ? '+' : '-'}\n–†–æ–∑–∫–ª–∞–¥–∫–∞: ${document.getElementById('check-layout').checked ? '+' : '-'}\n–ï—Ç–∏–∫–µ—Ç–∫–∞ –Ω–∞–Ω.: ${document.getElementById('check-label-applied').checked ? '+' : '-'}\n–ö–æ–º–µ–Ω—Ç–∞—Ä: ${document.getElementById('lbl-comment').value}`;
            } else {
                sectionName = "–ñ—É—Ä–Ω–∞–ª: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è";
                report = `–ß–∞—Å: ${document.getElementById('tst-time').value}\n–í–∞—Ä–Ω–∏–∫: ${document.getElementById('tst-cookName').value}\n–ü—Ä–æ–¥—É–∫—Ç: ${document.getElementById('tst-product').value}\n–ó–∞–≤–¥–∞–Ω–Ω—è: ${document.getElementById('tst-task').value}\n–î–∞—Ç–∞ –≤–∞—Ä–∫–∏: ${document.getElementById('tst-cookDate').value}\n–ö–æ–ª—ñ—Ä: ${document.getElementById('tst-color').value}\n–°–º–∞–∫: ${document.getElementById('tst-taste').value}\n–°—É—Ö—ñ: ${document.getElementById('tst-dry').value}%\npH: ${document.getElementById('tst-ph').value}\n–°—Ç—ñ–π–∫—ñ—Å—Ç—å: ${document.getElementById('tst-stab').value}`;
            }

            pendingReportData = {
                time: new Date().toLocaleTimeString('uk-UA'),
                employee: document.getElementById('employeeSelect').value,
                section: sectionName,
                report: report
            };
            showConfirmation(report);
        }

        function prepareChecklistReport(key) {
            let report = "";
            document.getElementById(`list-${key}`).querySelectorAll('.checklist-item').forEach(item => {
                const text = item.querySelector('.task-text').innerText;
                const status = item.classList.contains('completed') ? (item.classList.contains('has-problem') ? "‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê" : "‚úÖ –û–ö") : "‚ùå";
                const comment = item.querySelector('.comment-text').innerText;
                report += `${text}: ${status} ${comment ? '('+comment+')' : ''}\n`;
            });
            pendingReportData = {
                time: new Date().toLocaleTimeString('uk-UA'),
                employee: document.getElementById('employeeSelect').value,
                section: `–ß–µ–∫-–ª–∏—Å—Ç: ${key}`,
                report: report
            };
            showConfirmation(report);
        }

        function showConfirmation(text) {
            document.getElementById('confirmationText').innerText = text;
            const modal = document.getElementById('confirmationModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            document.getElementById('modalActions').style.display = 'flex';
            document.getElementById('modalSpinner').classList.add('hidden');
            document.getElementById('sendMsg').innerText = "";
        }

        async function executeSend() {
            const btnSpinner = document.getElementById('modalSpinner');
            const actions = document.getElementById('modalActions');
            const msg = document.getElementById('sendMsg');
            
            actions.style.display = 'none';
            btnSpinner.classList.remove('hidden');
            msg.innerText = "–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö...";

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(pendingReportData)
                });
                msg.innerText = "‚úÖ –î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ!";
                msg.classList.remove('text-red-500');
                msg.classList.add('text-emerald-600');
            } catch (e) {
                console.error(e);
                msg.innerText = "‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ (–¥–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ)";
                msg.classList.add('text-red-500');
            }

            const subject = encodeURIComponent(`${pendingReportData.section} - ${pendingReportData.employee}`);
            const body = encodeURIComponent(pendingReportData.report);
            
            setTimeout(() => {
                const mailtoLink = `mailto:Dyndarnastia@gmail.com,Buznitskiy7@gmail.com?subject=${subject}&body=${body}`;
                const link = document.createElement('a');
                link.href = mailtoLink;
                link.click();

                setTimeout(() => closeModal('confirmationModal'), 2000);
            }, 1000);
        }

        function closeModal(id) {
            const el = document.getElementById(id);
            el.classList.add('hidden');
            el.classList.remove('flex');
        }

        function saveState() {
            const state = {
                employee: document.getElementById('employeeSelect').value,
                items: {},
                inputs: {}
            };
            document.querySelectorAll('.checklist-item').forEach(el => {
                state.items[el.id] = {
                    completed: el.classList.contains('completed'),
                    problem: el.classList.contains('has-problem'),
                    info: el.classList.contains('has-info'),
                    comment: el.querySelector('.comment-text').innerText
                };
            });
            document.querySelectorAll('input, select, textarea').forEach(el => {
                if (el.id) state.inputs[el.id] = (el.type === 'checkbox') ? el.checked : el.value;
            });
            localStorage.setItem('qcState_v27', JSON.stringify(state));
        }

        function loadState() {
            const raw = localStorage.getItem('qcState_v27');
            if (!raw) return;
            const state = JSON.parse(raw);
            if (state.employee) {
                document.getElementById('employeeSelect').value = state.employee;
                document.getElementById('employeeSelectionHint').classList.add('hidden');
            }
            if (state.items) {
                Object.keys(state.items).forEach(id => {
                    const el = document.getElementById(id);
                    const s = state.items[id];
                    if (el && s) {
                        if(s.completed) el.classList.add('completed');
                        if(s.problem) { el.classList.add('has-problem'); el.querySelector('.comment-text').classList.add('alert'); }
                        if(s.info) { el.classList.add('has-info'); el.querySelector('.comment-text').classList.add('info'); }
                        if(s.comment) {
                            el.querySelector('.comment-text').innerText = s.comment;
                            el.querySelector('.comment-text').classList.remove('hidden');
                        }
                    }
                });
            }
            if (state.inputs) {
                Object.keys(state.inputs).forEach(id => {
                    const el = document.getElementById(id);
                    if(el) {
                        if (el.type === 'checkbox') el.checked = state.inputs[id];
                        else el.value = state.inputs[id];
                    }
                });
                
                const tmVal = state.inputs['lbl-tm'];
                if(tmVal) {
                   updateProductList(tmVal);
                   if(state.inputs['lbl-product']) {
                       document.getElementById('lbl-product').value = state.inputs['lbl-product'];
                   }
                }
            }
        }
    </script>
</body>
</html>